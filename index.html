<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>ACCA TX (UK) FA2024 è®²å¸ˆç²¾è®²å›¾è°±</title>
    <script src="https://cdn.jsdelivr.net/npm/echarts@5.4.3/dist/echarts.min.js"></script>
    <style>
        /* === ç§»åŠ¨ç«¯æ²‰æµ¸å¼è®¾è®¡ === */
        body { 
            margin: 0; padding: 0; overflow: hidden; 
            background-color: #f7f9f9; /* æ™¨é›¾ç™½èƒŒæ™¯ï¼Œæå…¶æŠ¤çœ¼ */
            font-family: -apple-system, "PingFang SC", "Helvetica Neue", sans-serif;
        }
        #main { width: 100vw; height: 100vh; }

        /* é¡¶éƒ¨æç®€æ ‡é¢˜ */
        .header {
            position: absolute; top: 0; left: 0; right: 0;
            padding: 12px 20px; z-index: 10;
            background: rgba(255,255,255,0.8); backdrop-filter: blur(10px);
            border-bottom: 1px solid rgba(0,0,0,0.03);
            display: flex; justify-content: space-between; align-items: center;
        }
        .header h1 { margin: 0; font-size: 16px; color: #546e7a; font-weight: 600; }
        .header .badge { 
            background: #78909c; color: #fff; padding: 2px 8px; 
            border-radius: 6px; font-size: 10px; letter-spacing: 1px; 
        }

        /* åº•éƒ¨è¯¦æƒ…å¡ç‰‡ (Bottom Sheet) */
        .sheet {
            position: absolute; bottom: 0; left: 0; right: 0;
            background: #ffffff;
            border-radius: 20px 20px 0 0;
            box-shadow: 0 -10px 40px rgba(0,0,0,0.08);
            padding: 25px; z-index: 100;
            transform: translateY(110%); /* é»˜è®¤éšè— */
            transition: transform 0.3s cubic-bezier(0.19, 1, 0.22, 1);
            max-height: 70vh; overflow-y: auto;
        }
        .sheet.active { transform: translateY(0); }

        /* å¡ç‰‡å†…éƒ¨æ’ç‰ˆ */
        .sheet-header { display: flex; justify-content: space-between; margin-bottom: 20px; border-bottom: 1px solid #f0f0f0; padding-bottom: 10px; }
        .sheet-title { margin: 0; font-size: 20px; color: #2c3e50; font-weight: 700; }
        .close-btn { font-size: 24px; color: #b0bec5; cursor: pointer; padding: 0 10px; }

        /* å†…å®¹æ¨¡å—æ ·å¼ */
        .block { margin-bottom: 18px; }
        .tag { 
            display: inline-block; font-size: 11px; padding: 3px 8px; 
            border-radius: 4px; margin-bottom: 6px; font-weight: 600; color: #fff;
        }
        /* é¢œè‰²å®šä¹‰ */
        .tag-def { background: #95a5a6; } /* ç°è‰²å®šä¹‰ */
        .tag-rule { background: #74b9ff; } /* è“è‰²å…¬å¼ */
        .tag-case { background: #55efc4; } /* ç»¿è‰²æ¡ˆä¾‹ */
        .tag-trap { background: #ff7675; } /* çº¢è‰²é™·é˜± */

        .content-text { font-size: 14px; color: #34495e; line-height: 1.6; }
        
        /* æ¼‚äº®çš„å…¬å¼/æ¡ˆä¾‹æ¡† */
        .box { padding: 12px; border-radius: 8px; margin-top: 5px; font-size: 13px; }
        .box-rule { background: #f0f8ff; border-left: 4px solid #74b9ff; color: #2c3e50; font-family: 'Menlo', monospace; }
        .box-case { background: #e8f8f5; border-left: 4px solid #55efc4; color: #2d3436; }
        .box-trap { background: #fff5f5; border-left: 4px solid #ff7675; color: #c0392b; }

        /* å¼•å¯¼æç¤º */
        .tip-overlay {
            position: absolute; top: 50%; left: 50%; transform: translate(-50%, -50%);
            background: rgba(0,0,0,0.6); color: #fff; padding: 10px 20px;
            border-radius: 20px; font-size: 13px; pointer-events: none;
            animation: fadeOut 3s 2s forwards;
        }
        @keyframes fadeOut { to { opacity: 0; } }
    </style>
</head>
<body>

    <div class="header">
        <h1>TX (UK) çŸ¥è¯†å›¾è°±</h1>
        <span class="badge">FA2024 | 25/26</span>
    </div>

    <div id="main"></div>
    <div class="tip-overlay">ğŸ‘‰ ç‚¹å‡»èŠ‚ç‚¹æŸ¥çœ‹è®²å¸ˆç¬”è®°</div>

    <div class="sheet" id="detailSheet">
        <div class="sheet-header">
            <h2 class="sheet-title" id="nodeTitle">Topic</h2>
            <div class="close-btn" onclick="closeSheet()">Ã—</div>
        </div>
        <div id="sheetContent"></div>
    </div>

    <script type="text/javascript">
        var chartDom = document.getElementById('main');
        var myChart = echarts.init(chartDom);
        
        // ================== èµ„æ·±è®²å¸ˆå†…å®¹åº“ (FA2024 Update) ==================
        
        const taxData = {
            name: "TX-UK æ ¸å¿ƒä½“ç³»",
            symbolSize: 25,
            itemStyle: { color: '#2c3e50' }, // æ·±ç°æ ¹èŠ‚ç‚¹
            children: [
                // 1. Income Tax
                {
                    name: "Income Tax\n(ä¸ªç¨)",
                    itemStyle: { color: '#ffaaa5' }, // è«å…°è¿ªç²‰
                    children: [
                        {
                            name: "NS/Sav/Div\nç¨ç‡åˆ†å±‚",
                            info: {
                                def: "æ”¶å…¥å¿…é¡»æŒ‰é¡ºåºçº³ç¨ï¼š1. éå‚¨è“„(å·¥èµ„/æˆ¿ç§Ÿ) -> 2. å‚¨è“„(åˆ©æ¯) -> 3. è‚¡æ¯ã€‚",
                                rule: "<b>Dividend Rates:</b> 8.75% (Basic) / 33.75% (Higher) / 39.35% (Add) [cite: 6]<br><b>PSA:</b> Basic Â£1,000 / Higher Â£500 / Add Â£0 [cite: 6]",
                                case: "Jackæ˜¯é«˜ç¨ç‡çº³ç¨äººã€‚æ”¶åˆ° Â£2,000 è‚¡æ¯ã€‚<br>å‰ Â£500 (Nil Band) = 0ç¨ã€‚<br>å‰©ä½™ Â£1,500 @ 33.75% = Â£506.25ã€‚",
                                trap: "ä¸€å®šè¦å…ˆç”¨æ‰ NS Income å ç”¨çš„ Basic Bandï¼Œå†çœ‹ Savings å’Œ Dividends è½å…¥å“ªä¸ªç¨ç‡åŒºé—´ï¼"
                            }
                        },
                        {
                            name: "Employment\n(é›‡ä½£ç¦åˆ©)",
                            info: {
                                def: "å·¥èµ„è–ªé‡‘ + å®ç‰©ç¦åˆ© (Benefits)ã€‚é‡ç‚¹æ˜¯è½¦å’Œæ²¹ã€‚",
                                rule: "<b>Car:</b> List Price Ã— % (55gèµ·æ­¥16%, æ¯5g+1%, Max 37%) [cite: 21]<br><b>Diesel:</b> åªè¦ç¬¦åˆ RDE2 å°±ä¸åŠ  4% (è€ƒè¯•è½¦è¾†é€šå¸¸ç¬¦åˆ) [cite: 19]<br><b>Fuel:</b> Â£27,800 Ã— Car % [cite: 27]",
                                case: "æ±½æ²¹è½¦æ’æ”¾ 100g/kmã€‚<br>% = 16% + (100-55)/5 = 25%ã€‚<br>è‹¥ List Price Â£20kï¼ŒBenefit = Â£5,000ã€‚<br>å¦‚æœ‰ç§äººæ±½æ²¹ï¼ŒFuel Benefit = Â£27,800 Ã— 25% = Â£6,950ã€‚",
                                trap: "ç”µåŠ¨è½¦ (0g/km) ç¦åˆ©ä»…ä»…æ˜¯ 2%ï¼[cite: 22] è¿™æ˜¯é€åˆ†é¢˜ã€‚"
                            }
                        },
                        {
                            name: "NIC\n(å›½æ°‘ä¿é™©)",
                            itemStyle: { color: '#ff8b94' }, // æ·±ç²‰å¼ºè°ƒ
                            info: {
                                def: "FA2024 è´¹ç‡æš´è·Œï¼Œåƒä¸‡åˆ«ç”¨æ—§ä¹¦æ•°æ®ï¼",
                                rule: "<b>Class 1 (Primary):</b> Â£12,570-Â£50,270 ç¨ç‡ <span style='color:red'>8%</span> (åŸ10/12%) [cite: 82]<br><b>Class 4:</b> åˆ©æ¶¦åŒåŒºé—´ ç¨ç‡ <span style='color:red'>6%</span> (åŸ9%) [cite: 82]",
                                case: "è‡ªé›‡åˆ©æ¶¦ Â£40,000ã€‚<br>Class 4 NIC = (Â£40,000 - Â£12,570) Ã— 6% = Â£1,645.80ã€‚",
                                trap: "Class 2 ç°åœ¨é€šå¸¸æ˜¯ 0 (ä½†åœ¨æŸäº›ç‰¹å®šä½æ”¶å…¥è‡ªæ„¿ç¼´çº³æ—¶é™¤å¤–)ï¼Œåšè®¡ç®—é¢˜æ—¶é»˜è®¤ä¸åŒ…å« Class 2 é‡‘é¢ï¼Œé™¤éé¢˜ç›®ç‰¹æ®Šè¦æ±‚ã€‚"
                            }
                        }
                    ]
                },
                // 2. Corporation Tax
                {
                    name: "Corp Tax\n(å…¬å¸ç¨)",
                    itemStyle: { color: '#a8d8ea' }, // è«å…°è¿ªè“
                    children: [
                        {
                            name: "TTP & Rates\n(ç®—ç¨)",
                            info: {
                                def: "åº”ç¨æ€»åˆ©æ¶¦ (TTP) = Trading Profit + Property + Interest + Gains - QCDã€‚",
                                rule: "<b>Lower Limit Â£50k:</b> 19%<br><b>Upper Limit Â£250k:</b> 25%<br><b>Marginal Relief:</b> (U - A) Ã— 3/200 [cite: 48, 50]",
                                case: "TTP=Â£150k, æ— å…³è”å…¬å¸ã€‚<br>åŸºæœ¬ç¨: 150k Ã— 25% = Â£37,500ã€‚<br>å‡å…: (250k-150k) Ã— 3/200 = Â£1,500ã€‚<br>åº”ä»˜: Â£36,000ã€‚",
                                trap: "Augmented Profits (AP) åŒ…å«å…ç¨çš„åˆ†çº¢ (FGL)ï¼è™½ç„¶åˆ†çº¢ä¸äº¤ç¨ï¼Œä½†å®ƒä¼šæŠŠä½ æ¨å‘ 25% çš„é«˜ç¨ç‡åŒºé—´ã€‚"
                            }
                        },
                        {
                            name: "Cap Allowances\n(èµ„æœ¬å‡å…)",
                            info: {
                                def: "ä»£æ›¿æŠ˜æ—§çš„ç¨åŠ¡æ‰£é™¤ã€‚FA24 å¼•å…¥äº† Full Expensingã€‚",
                                rule: "<b>Full Expensing:</b> å…¨æ–°ã€ä¸»æ± èµ„äº§ -> 100% FYA (æ— ä¸Šé™) [cite: 45]<br><b>AIA:</b> Â£1,000,000 (ç”¨äºäºŒæ‰‹æˆ–ç‰¹æ± ) [cite: 45]<br><b>SRP:</b> 50% FYA + 6% WDA [cite: 45]",
                                case: "å…¬å¸ä¹°äº†ä¸€å°å…¨æ–°æœºå™¨ Â£2,000,000 (Main Pool)ã€‚<br>ç›´æ¥äº«å— 100% Full Expensingã€‚<br>å½“æœŸ TTP å‡å°‘ Â£2mã€‚",
                                trap: "åªæœ‰**å…¬å¸**æ‰æœ‰ Full Expensing å’Œ 50% SRP FYAã€‚ä¸ªä½“æˆ· (Sole Trader) åªæœ‰ AIAï¼ä¸è¦ææ··ã€‚"
                            }
                        }
                    ]
                },
                // 3. CGT
                {
                    name: "CGT\n(èµ„æœ¬åˆ©å¾—)",
                    itemStyle: { color: '#aa96da' }, // è«å…°è¿ªç´«
                    children: [
                        {
                            name: "Individuals\n(ä¸ªäºº)",
                            info: {
                                def: "FA2024 å¯¹æˆ¿ä¸œå’Œæ•£æˆ·â€œé‡æ‹³å‡ºå‡»â€ï¼šå…ç¨é¢å‡åŠï¼Œä½†æˆ¿äº§ç¨ç‡å¾®é™ã€‚",
                                rule: "<b>AEA (å…ç¨é¢):</b> ä»…å‰© Â£3,000 [cite: 74]<br><b>Resi Property:</b> 18% / <span style='color:red'>24%</span> (åŸ28%) [cite: 74]<br><b>Other:</b> 10% / 20%",
                                case: "é«˜æ”¶å…¥è€…å–æŠ•èµ„æˆ¿èµš Â£13,000ã€‚<br>åº”ç¨ = 13,000 - 3,000 = Â£10,000ã€‚<br>ç¨ = Â£10,000 Ã— 24% = Â£2,400ã€‚",
                                trap: "è®°å¾—å…ˆæŠŠ Â£3,000 çš„ AEA æŠµæ‰£ç»™ç¨ç‡æœ€é«˜çš„é‚£éƒ¨åˆ†æ”¶ç›Šï¼ˆé€šå¸¸æ˜¯ Residential Property @ 24%ï¼‰ã€‚"
                            }
                        },
                        {
                            name: "BADR\n(å•†ä¸šèµ„äº§)",
                            info: {
                                def: "Business Asset Disposal Relief (åŸä¼ä¸šå®¶å‡å…)ã€‚",
                                rule: "<b>Rate:</b> 10% (ä¸ç®¡ä½ æ”¶å…¥å¤šå°‘)<br><b>Limit:</b> ç»ˆèº« Â£1 million [cite: 78]<br><b>æ¡ä»¶:</b> æ‹¥æœ‰å¹¶ç»è¥ 2 å¹´ä»¥ä¸Šã€‚",
                                case: "å‡ºå”®ç»è¥ 5 å¹´çš„å’–å•¡åº—ï¼Œè·åˆ© Â£500kã€‚<br>å…¨é¢äº«å— BADRã€‚<br>CGT = (500k - 3k) Ã— 10% = Â£49,700ã€‚",
                                trap: "BADR ä¼šå ç”¨ä½ çš„ Basic Rate Bandï¼å³ä½¿å®ƒåªäº¤ 10%ï¼Œä¹Ÿä¼šæŠŠä½ å…¶ä»–çš„æ”¶ç›Šæ¨å‘ 20% æˆ– 24% çš„é«˜ç¨ç‡ã€‚"
                            }
                        }
                    ]
                },
                // 4. VAT
                {
                    name: "VAT\n(å¢å€¼ç¨)",
                    itemStyle: { color: '#fce38a' }, // è«å…°è¿ªé»„
                    children: [
                        {
                            name: "Registration\n(æ³¨å†Œ)",
                            info: {
                                def: "å¼ºåˆ¶æ³¨å†Œé—¨æ§› FA24 ä¸Šè°ƒäº†ï¼",
                                rule: "<b>æ³¨å†Œ:</b> è¿‡å»12ä¸ªæœˆé”€å”® > Â£90,000 [cite: 67]<br><b>æ³¨é”€:</b> æœªæ¥12ä¸ªæœˆé”€å”® < Â£88,000 [cite: 68]",
                                case: "æˆªè‡³ 2025 å¹´ 9 æœˆ 30 æ—¥ï¼Œè¿‡å» 12 ä¸ªæœˆé”€å”®é¢ Â£91,000ã€‚<br>å¿…é¡»åœ¨ 30 å¤©å†…é€šçŸ¥ HMRCã€‚<br>æ³¨å†Œç”Ÿæ•ˆæ—¥ï¼š2025 å¹´ 11 æœˆ 1 æ—¥ã€‚",
                                trap: "æ˜¯çœ‹â€œè¿‡å» 12 ä¸ªæœˆâ€ï¼Œä¸æ˜¯â€œä¸Šä¸€ä¼šè®¡å¹´åº¦â€ï¼æ¯ä¸ªæœˆåº•éƒ½è¦æ»šåŠ¨æ£€æŸ¥ã€‚"
                            }
                        },
                        {
                            name: "Discounts\n(æŠ˜æ‰£å¤„ç†)",
                            info: {
                                def: "ç°é‡‘æŠ˜æ‰£ (PPD) çš„ VAT è®¡ç®—è§„åˆ™ã€‚",
                                rule: "VAT å¿…é¡»åŸºäº<b>å®é™…æ”¶åˆ°çš„é‡‘é¢</b>è®¡ç®—ã€‚<br>å¦‚æœå®¢æˆ·æ‹¿äº†æŠ˜æ‰£ï¼ŒVAT æŒ‰æŠ˜æ‰£åç®—ï¼›æ²¡æ‹¿ï¼ŒæŒ‰å…¨é¢ç®—ã€‚",
                                case: "å•†å“ Â£100ï¼Œæä¾› 5% PPDã€‚<br>è‹¥å®¢æˆ·ä»˜æ¬¾ Â£95ï¼ŒVAT = Â£95 Ã— 20% = Â£19ã€‚<br>è‹¥å®¢æˆ·ä»˜ Â£100ï¼ŒVAT = Â£20ã€‚",
                                trap: "å‘ç¥¨ä¸Šå¿…é¡»å†™æ¸…æ¥šï¼š'å¦‚æœæœªå–æŠ˜æ‰£ï¼Œç”±äº PPD æœªå–ï¼Œéœ€è¡¥äº¤ VAT Â£1'ã€‚"
                            }
                        }
                    ]
                },
                // 5. IHT
                {
                    name: "IHT\n(é—äº§ç¨)",
                    itemStyle: { color: '#95e1d3' }, // è«å…°è¿ªç»¿
                    children: [
                        {
                            name: "Death Tax\n(æ­»äº¡ç¨)",
                            info: {
                                def: "äººæ­»åå¯¹é—äº§å¾çš„ç¨ã€‚è®°å¾—å…ˆæ‰¾ RNRBã€‚",
                                rule: "<b>NRB:</b> Â£325,000 [cite: 63]<br><b>RNRB:</b> Â£175,000 (ç•™ç»™ç›´ç³»åä»£çš„ä¸»å±…æ‰€) [cite: 63]<br><b>Rate:</b> 40%",
                                case: "ç•™ç»™å„¿å­çš„æˆ¿å­ä»·å€¼ Â£500kã€‚<br>å…ç¨é¢ = 325k + 175k = Â£500kã€‚<br>åº”ç¨é¢ = 0ã€‚",
                                trap: "å¦‚æœæ˜¯ç•™ç»™é…å¶ (Spouse)ï¼Œç›´æ¥ Exempt (å…ç¨)ï¼Œä¸éœ€è¦ç”¨ NRB/RNRBã€‚ç•™ç€ç»™ç¬¬äºŒä¸ªæ­»çš„äººç”¨ã€‚"
                            }
                        },
                        {
                            name: "Lifetime\n(ç”Ÿå‰èµ ä¸)",
                            info: {
                                def: "PET (ç»™ä¸ªäºº) vs CLT (ç»™ä¿¡æ‰˜)ã€‚",
                                rule: "<b>PET:</b> æ´»è¿‡ 7 å¹´ = å…ç¨ã€‚æ­»åœ¨ 7 å¹´å†… = é‡ç®—æ­»äº¡ç¨ã€‚<br><b>CLT:</b> é©¬ä¸Šäº¤ 20% (è¶…å‡º NRB éƒ¨åˆ†)ï¼Œæ­»åå¯èƒ½è¡¥äº¤ã€‚",
                                case: "é€å¥³å„¿ Â£400k (PET)ã€‚3 å¹´åå»ä¸–ã€‚<br>éœ€é‡ç®—ï¼šÂ£400k - Â£3k(AE) - Â£3k(AE) = Â£394kã€‚<br>æ‰£é™¤ NRB Â£325kï¼Œå‰©ä½™ Â£69k @ 40% = Â£27,600ã€‚<br>å†å‡å» Taper Relief (20% off)ã€‚",
                                trap: "Taper Relief æ˜¯å‡å…â€œç¨æ¬¾â€ï¼Œä¸æ˜¯å‡å…â€œä»·å€¼â€ï¼"
                            }
                        }
                    ]
                }
            ]
        };

        option = {
            backgroundColor: '#f7f9f9',
            series: [
                {
                    type: 'tree',
                    data: [taxData],
                    top: '15%',
                    bottom: '15%',
                    layout: 'orthogonal', // æ ‘çŠ¶å¸ƒå±€ï¼Œä»å·¦åˆ°å³
                    orient: 'TB', // Top to Bottom (æ‰‹æœºç«–å±æ›´é€‚åˆä¸Šä¸‹ç»“æ„)
                    symbol: 'emptyCircle',
                    symbolSize: 12,
                    initialTreeDepth: 2, // é»˜è®¤å±•å¼€å±‚çº§
                    
                    // è¿çº¿æ ·å¼
                    lineStyle: {
                        color: '#bdc3c7',
                        width: 1.5,
                        curveness: 0.5
                    },
                    
                    // èŠ‚ç‚¹æ–‡å­—æ ·å¼
                    label: {
                        position: 'left',
                        verticalAlign: 'middle',
                        align: 'right',
                        fontSize: 12,
                        color: '#666',
                        fontFamily: 'sans-serif'
                    },
                    
                    leaves: {
                        label: {
                            position: 'right',
                            verticalAlign: 'middle',
                            align: 'left'
                        }
                    },
                    
                    // äº¤äº’åŠ¨ç”»
                    expandAndCollapse: true,
                    animationDuration: 550,
                    animationDurationUpdate: 750
                }
            ]
        };

        // é’ˆå¯¹æ‰‹æœºå±å¹•è°ƒæ•´å¸ƒå±€æ–¹å‘
        if (window.innerWidth < 600) {
            // æ‰‹æœºç«¯ï¼šå‚ç›´æ ‘çŠ¶å›¾ (Top-Bottom)
            option.series[0].orient = 'TB'; 
            option.series[0].label.position = 'top';
            option.series[0].label.rotate = 0;
            option.series[0].leaves.label.position = 'bottom';
            option.series[0].leaves.label.rotate = 90; // æœ€åä¸€çº§æ–‡å­—ç«–æ’é˜²æ­¢é‡å 
            option.series[0].leaves.label.verticalAlign = 'middle';
            option.series[0].leaves.label.align = 'left';
            option.series[0].leaves.label.distance = 10;
            // ä¿®æ­£ï¼šè®©æœ€åä¸€çº§æ˜¾ç¤ºæ¨ªæ’ï¼Œé€šè¿‡åŠ å¤§é—´è·è§£å†³
            option.series[0].leaves.label.rotate = 0;
            option.series[0].layout = 'orthogonal';
        } else {
            // å¹³æ¿/ç”µè„‘ï¼šæ°´å¹³æ ‘çŠ¶å›¾ (Left-Right)
            option.series[0].orient = 'LR';
        }

        myChart.setOption(option);
        
        // ================= äº¤äº’é€»è¾‘ =================
        
        const sheet = document.getElementById('detailSheet');
        const titleDom = document.getElementById('nodeTitle');
        const contentDom = document.getElementById('sheetContent');

        myChart.on('click', function (params) {
            if (params.data.info) {
                showSheet(params.data);
            }
        });

        function showSheet(node) {
            const info = node.info;
            
            // æ ‡é¢˜æŸ“è‰²
            titleDom.innerText = node.name.replace('\n', ' ');
            titleDom.style.color = node.itemStyle ? node.itemStyle.color : '#333';

            let html = '';
            
            // 1. å®šä¹‰
            if (info.def) 
                html += `<div class="block"><span class="tag tag-def">ğŸ’¡ æ ¸å¿ƒæ¦‚å¿µ</span><div class="content-text">${info.def}</div></div>`;
            
            // 2. è§„åˆ™/å…¬å¼
            if (info.rule) 
                html += `<div class="block"><span class="tag tag-rule">ğŸ“ å¿…èƒŒå…¬å¼ (FA24)</span><div class="box box-rule">${info.rule}</div></div>`;
            
            // 3. æ¡ˆä¾‹
            if (info.case) 
                html += `<div class="block"><span class="tag tag-case">ğŸ“ ç»å…¸ä¾‹é¢˜</span><div class="box box-case">${info.case}</div></div>`;
            
            // 4. é™·é˜±
            if (info.trap) 
                html += `<div class="block"><span class="tag tag-trap">âš ï¸ é¿å‘æŒ‡å—</span><div class="box box-trap">${info.trap}</div></div>`;

            contentDom.innerHTML = html;
            sheet.classList.add('active');
        }

        function closeSheet() {
            sheet.classList.remove('active');
        }

        // ç‚¹å‡»ç©ºç™½å¤„å…³é—­é¢æ¿
        myChart.getZr().on('click', function (event) {
            if (!event.target) {
                closeSheet();
            }
        });

        window.addEventListener('resize', function() {
            myChart.resize();
        });
    </script>
</body>
</html>
